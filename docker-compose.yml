# Run docker-compose up
# Live long and prosper
version: '2'
services:
  rabbitmq:
    container_name: skf-rabbitmq_container
    image: rabbitmq:3.8.19
    environment:
        - RABBITMQ_DEFAULT_USER=admin
        - RABBITMQ_DEFAULT_PASS=admin-skf-secret
    ports:
        - "5672:5672"
        - "15672:15672"

  mysql:
    container_name: skf-mysql_container
    image: blabla1337/mysql
    restart: always
    environment:
      MYSQL_DATABASE: 'skf'
      MYSQL_ROOT_PASSWORD: 'admin-skf-secret'
      MYSQL_DEFAULT_PASS: 'admin-skf-secret'
      MYSQL_DEFAULT_USER: 'root'
    ports:
      - '3306:3306'
    volumes:
       - mysql_data:/var/lib/mysql

  nginx:
    container_name: skf-nginx_container
    restart: always
    image: nginx
    volumes:
      - ./Docker/compose/site.conf:/etc/nginx/nginx.conf
    ports:
      - "80:80"

  skf-angular:
    container_name: skf-angular_container
    depends_on:
      - "rabbitmq"
      - "nginx"
      - "mysql"
    restart: always
    image: "blabla1337/skf-angular:4.0.2"
    environment:
      - FRONTEND_URI=http://localhost
      - SKIP_LOGIN=skfprovider

  skf-api:
    container_name: skf-api_container
    depends_on:
      - "rabbitmq"
      - "nginx"
      - "mysql"
    restart: always
    volumes:
      - /home/celi/.kube/config:/home/user_api/.kube/config
    image: "blabla1337/skf-api:4.0.4"
    environment:
      - SKF_FLASK_DEBUG=False
      - SKF_API_URL=http://localhost/api
      - SKF_TESTING=False
      - SKF_DB_URL=mysql+pymysql://root:admin-skf-secret@mysql/skf?charset=utf8mb4
      - SKF_JWT_SECRET=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJza2Ytc2VjcmV0IiwibmFtZSI6ImFkbWluIiwiaWF0IjoxMjM0fQ.-dK5agVPCOp2BZMj1srQWK6UgliQnY8_R8H0cxEnlu0
      - SKF_LABS_DOMAIN=http://192.168.49.2
      - SKF_LABS_DEPLOY_MODE=port
      - RABBIT_MQ_CONN_STRING=rabbitmq
      - LABS_KUBE_CONF=YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNdmFrTkRRV1ZoWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplazFFUlhoTlJFRjVUWHBCZDA1R2IxaEVWRTE2VFVSRmQwNTZRWGxOZWtGM1RrWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVG1vdkNuWkthVzh5VTNCTlVVbHRVVTFyUTI4MU1Xd3pNMjA0TWt0bWVqTkhWRkpvYnpWcGRsbEtUMklyTDJkVmJ6Qkdja1V3Tnk5ak5FTkdWM05hVmxOWUsxa0tNbVJXUzFSMVZFdHJRVE01Um1oMU5WaERiVmxKU2l0dVpWcGhTVXR3YURodVQwMVBibWROWWt4V1dYZFZSSE5CVFdGQ2JsWnNOV2xwS3pkWVVFZzBkQXBYZW1GdkwwSkdWR1lyY21SalQwRldUbkpvYVhWRWVHVkVVM2hFSzA1Q2VVVTNNbVI0WjBwd1dUVnZUM1Z2UjFwVFpqSjJlVmRsYTJGalZYcDZURWczQ21obFZVazRaRXQyUjJSSFVEWnZNbGxHU0dwTFpIQm5WbVk1UVVSa2NUWlhTV3BvYUVwa1JrcDBkM0pMU25WQ1JtZFJZMUZUVURKUmFGaEZTbFI1UkhVS1ZYbDNNVkp0U0hNemQyNUhVVE12WmtGSU9WTlZUVVJUVldNNVppOXVOSE16TDB4eGNYVk1kbTR4TTFWbWQyWjRUR1ZHV0VaWldYQjZPVTUyVFVSUGNBb3dOVTlxUmtKMVRtb3JOVlJuZG5kRFVYSlZRMEYzUlVGQllVNWFUVVpqZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWkVLMGd6VjBnek9ITXlRVk5NVlhrNGRGSXlSMkpKUkhOeWJqSk5RbFZIUVRGVlpFVlJVVThLVFVGNVEwTnRkREZaYlZaNVltMVdNRnBZVFhkRVVWbEtTMjlhU1doMlkwNUJVVVZNUWxGQlJHZG5SVUpCVGs5SE5GaFFVblZPZEhSTmN6SkRSREY2V1FwbVoydE9WVzVUVDFkc1pEWTVhR0pFUmxkTGJYY3hVMGs1WkdkSFFVRTRXWE5WYlZaTWJVcEdiVU5pY0UwclZYcExjRlpFYlZSblVtRTRSR2gyYlVGTUNrUnBRWGQxY25WcVRXdFlielpQTjI5U2NYaDVZMWRuV25wclpuaEJhV1JtTkhkbFNEZDBNVkpsWTJGbE5WbHJRbmh6Ymt0bldHcHVVbTlPSzFWT1dIa0tXbTV6TW1kaFQzVktUMmszVFc5RFlpdFpRVll3ZDJwdGMzSkJMM1pVVjNadWMwcDZlWGhtYzJ4b2RXczNTMkkyUlN0c2FESnhjRnBGWlRCQlJpOURUd3A1YTFkb1FUSnBjRVJhUTA5aUt6VnhXWEp1UlM5d2NDdFJVa3RUUTFkSUwzcFRiRmRyUWtkU09FTlROV1kzYWtNM1JIcE1jR3B0ZWpOR05TOTJZVzkwQ2pSUlRVNVhaSEo1VkV4bmNXdFlaVTVVTldreFZVUktXV1ExVHpkeldXRlZPVGd3YmtFNWFIRldXalZZYzFka1JuVXpWMk1yWTBjNFdtMHlaMEY0UjNJS1MySkZQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBzZXJ2ZXI6IGh0dHBzOi8va3ViZXJuZXRlcy5kb2NrZXIuaW50ZXJuYWw6NjQ0MwogIG5hbWU6IGRvY2tlci1kZXNrdG9wCmNvbnRleHRzOgotIGNvbnRleHQ6CiAgICBjbHVzdGVyOiBkb2NrZXItZGVza3RvcAogICAgdXNlcjogZG9ja2VyLWRlc2t0b3AKICBuYW1lOiBkb2NrZXItZGVza3RvcApjdXJyZW50LWNvbnRleHQ6IGRvY2tlci1kZXNrdG9wCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZTogZG9ja2VyLWRlc2t0b3AKICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJSYWtORFFXbHhaMEYzU1VKQlowbEpSakZzUlVoVWFucDNRMVYzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRYcEJlRTFVUVhkTmFrMTNUVVJTWVVaM01IbE9SRUY0VFZSQmVFNUVTVEZPVkVKaFRVUlplQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNjM2RIVVZsRVZsRlJSRVY0U210aU1rNXlXbGhKZEZwdE9YbE1WMUpzQ21NeWREQmlNMEYzWjJkRmFVMUJNRWREVTNGSFUwbGlNMFJSUlVKQlVWVkJRVFJKUWtSM1FYZG5aMFZMUVc5SlFrRlJRM3BSTDBOcVRuZE1lRXBQV0drS05uZHpWWEJLVVRGdWJFUlhiMFJIUzBGNllrOW9lVkoyU0ZOTFJUVkNhRWN6VUZJeU9VaEZLekJWYW1JeFUzRlpTSFptU0ZOUlZ6SnZjMGxFYTFGWlZncENRVlpPZWtsU1l6TlhRWEJTVjBJeVZESnRZMlp3TjFCS2QyOUdWalJGYlhCQ1kyVmFWRTl3YzI5dVNVcE9TMmMyYVhFelNHVlBaelZXUWpGNE9UZ3hDa1JrUzNGUWNHaENOVmxaSzFRMFRrNUlOVmM1VVV0TlVXWjVhbTV4Um05Wk1rVkVhbWMzT1ZWNEwyWlNVbkE0V1VGeFprTjFaREZCZDBwbGRUTTROM2dLTm0wdmREZzFRVUp4VkRGek1sZEJOR05YUkhoNGFVSnBaelowVkc4MVZFbHdkSHBMU1RoU01GTm9iSEZFVHk5TlRYWXlNREo1YUdsVGF6SXJja2hwWmdwV1NYQmhjbU4zY0VSbVkyaFZla1UzY0V4WGFHMDVWMmx1VWpObGNGcGFaRWhUUzFCVVZTdDZSa3hSYVRWTFFUaHhibk0yVURKVFdIcE9NVWx5VUZNd0NrWmxMMnBpY21WdVFXZE5Ra0ZCUjJwa1ZFSjZUVUUwUjBFeFZXUkVkMFZDTDNkUlJVRjNTVVp2UkVGVVFtZE9Wa2hUVlVWRVJFRkxRbWRuY2tKblJVWUtRbEZqUkVGcVFVMUNaMDVXU0ZKTlFrRm1PRVZCYWtGQlRVSTRSMEV4VldSSmQxRlpUVUpoUVVaRUswZ3pWMGd6T0hNeVFWTk1WWGs0ZEZJeVIySkpSQXB6Y200eVRVSXdSMEV4VldSRlVWRlhUVUpUUTBWdFVuWlpNblJzWTJreGJXSXpTWFJhUjFaNllUTlNkbU5FUVU1Q1oydHhhR3RwUnpsM01FSkJVWE5HQ2tGQlQwTkJVVVZCV1VsT2JEZzVXVmhET1hSSUszUTJkemhyWVZWWWRrVTNRekZIT0RSRU5uRTNiMGN6YTNGTWIyOUxORWgyTVdGUFRVWllMMHh0VkVrS2FrMUhSRUYxVEhGaWJpOVVVa05rUm1zcmVFbHhkVEZYVVZaYVQzTXpWMWx1TTNZemRtZzNkM1psVEhGWVYzcGlla3BTYUVzMFdIaFFVV2htZW5KcGF3cEJUQzk2SzJ0TFpHUmlNQ3RIT1RVME9XcE5OVm8xVVRkMlVsZzNibmxOUkhOM2EzbE1jakpOUjFCbFJFZE9OVlEyV1c5dUsyZHpTVWxzWnpjMGRFWXJDbTl2V0ROd0t5OVRVRms1YldodlNXNWlPRXM1UjA1RVpUZENOa1J0TUVGME9XbHFaRW93YVdaWE1saG9hWFJ1TTFSemRqSTVkRm96WlZaeGRXcG1ReXNLTTNsRk1TOTJTbFoxWVdOTlVGQkZXRVl6VUc5T1ZUTlpNMlY2WVZKamJtRnJPRE5FWVZVclNESk5XR0ppUjFOU1ZrdzRPSEp1V2k5c09URlpiVmsxU2dveFdXbFJjMVJ6TUhsUGFGSlJkV0ZhVEM5cmMyUjNhbUp6Um1wTFZXYzlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmIyZEpRa0ZCUzBOQlVVVkJjekJRZDI5NlkwTTRVMVJzTkhWelRFWkxVMVZPV2pWUk1YRkJlR2xuVFRKNmIyTnJZbmd3YVdoUFVWbFNkSG93Q21SMlVuaFFkRVpKTWpsVmNXMUNOek40TUd0R2RIRk1RMEUxUlVkR1VWRkdWR041UlZoT01XZExWVlpuWkdzNWNHNUlObVY2ZVdOTFFsWmxRa3B4VVZnS1NHMVZlbkZpUzBwNVExUlRiMDl2Y1hSNE0ycHZUMVpSWkdObVprNVJNMU54YWpaWlVXVlhSMUJySzBSVVVpdFdkbFZEYWtWSU9HODFObWhoUjA1b1FRbzBORTh2VmsxbU16QlZZV1pIUVV0dWQzSnVaRkZOUTFoeWRDOVBPR1Z3ZGpkbVQxRkJZV3M1WWs1c1owOUlSbWM0WTFsbldXOVBjbFUyVDFWNVMySmpDbmxwVUVWa1JXOWFZV2Q2ZG5wRVREbDBUbk52V1d0d1RuWnhlRFJ1TVZOTFYzRXpUVXRSTXpOSlZrMTRUelpUTVc5YWRsWnZjREJrTTNGWFYxaFNNR2tLYWpBeFVITjRVekJKZFZOblVFdHdOMDlxT1d0c09IcGtVMHQ2TUhSQ1dIWTBNall6Y0hkSlJFRlJRVUpCYjBsQ1FVUjVWMkU1UW1WSFYzQjZUa0prWWdwd1YxVlhjM1JxYTFwNVNVUkNiblJGTVhSTk5uSmlLelJOZVVORVJIZHNNRk5HVDJ0RWJIQlRNV0pOYlN0eWVISlRkMlJhTUUxeFNHVTVaRVYyY1RrdkNuRnRUUzlEYTFaM2RFd3hLMHQ2YjFKWlVIQTFaVk5qSzFwSk5teHZiM0o1ZW5KWFFrMTBURm9yZFU1blVIRm5VVkJPZFdwRFNHOXhlSFZVYmpWeVRFSUtkSG9yS3pWRGNuaGlhM1pHUWk5WFlrSlVjblpwTmpGYWNsQlBUMU0xY0hwVVZtdHhlakIzWTB0clEwMUxUVTVFTXpnM2JsRkVTalZwTTBWWFFrZHBUZ28xUkdsUE1WbDRiemRVWTFJME4yNXpaV1puTDNobFlVOU1kRXM0Ylc4M1ZXb3lUWHB6WVdOYWIySTFRemhrWlZNM1NrdFpNalY2V1dsU1pXZE5iaTlEQ21SU2VURk1XV0pqWWtOclF6TnhNVXh5UkZjelZWSk1SRVpyVWxOYU5sWkhUalpDUzJoSmFsQndibEZqYVhwUFlVTnZXRmN3U1RFM1ZYTjJRMUZNV1c0S1YyczRNR2RaUlVObldVVkJlRzU1WWpWWVFuQlhWWFY0TTA5Q1IySjFlSGd5UzFWUE5FUkpUbnBxTDBGeVJrRTJjMEpWY0dFMmJVOVRkaTlxYTNSMFNBcDVXVGwyUW1oWkx5dHhSVFJXYlUxM05FdHFRWFpuVDNwMlJGcHVhVU5LY21KT00zaGplazVwUkVVNGQzcHRVSHBPV1hvMEwzUlBZVWd6UjB4V2FIaGtDbWhVUVhGeWExYzVlSE52WldkaVlVMUlaeTlGTkhCV1YyUTJTRTVOVUdvMGIxcFZkV1ZoT0ZoU2FVRnZOMlZIUjFKeFVGZGxaMk5EWjFsRlFUVjZWMGNLVjJRNVZHbExZVGd5YjB4dFJGbDZiRnBsVFVwS1dsUlhielkwUjB4VlNVbFlVMUJoT1M5TVp6ZHhOVmhFTjNKSGQwcGpUSE4zTDJSR2RVUllUMUExZVFwaVJFZ3JaazVQU0ZGd2FucHdaaXR4YmpkemRXSlVWRWN5ZERoMUwxcDJWVWhIVDJkeGIxZG5RVkJSYTNOS2VVOHlhRWR2YWxSVlJrcFJWVWxaZUZZdkNsaHpNbGhVV1dGTVoyUlNURmxrYzJoamRGTkNhRFozWjFFeloxRXpTbGxxVFhodEt6ZFhSVU5uV1VFNEsyMDVVMm8zVW5Rd1NXd3lSMEpxVEZoNWVXa0tjVU5NYmpCaWFsbEZiRWcxU0dwVVNtWTVZbGd3Y1VZMlpsSTNTRTFWVEdWek5HZHBWVXBsWWxGbmFIa3dZM0JyVjNKUVRVeEpjamxYWVVZMEt6QnZVZ3BwYVZoNGFFZHRjelp0T1U5SFVISlNRM1IzT0ZCWWJuVkRkelJLYVVoR1lYZzJPVEZHYzNZd01VbGxSM2hxVWtvd1FVcHRjMmRhT0dadFRIaHNjWFZpQ25sS09HTnNlVkZLVlZSM1FubFFWbVJ2YkhaNk5WRkxRbWRJWmxGeGQwUnFNVWgzWVU4dkwxbHRZazF1T0hKRWMwTkpPWEpLUW1aTFZsQlZZa3BSTlhZS1UwVm1OVzB3Y2xaSFpGUlROamRDWlVabVowUkliMVlyYlhOdE1GRnJUMFJZVDJZdlJHcGpZVFJDYVVRNWVqSjZWMGx1VEUxamJUSnZjbXhYUTFsT01BcDBXWFp2YkRGUmJrMVBVVGxJVjBsM2FVaEpNSEZoWmxob1pFMXFSSFJDYjBwcFNrMTFVSEpqYzNaMlVTOVFTblUwV0d0WVdEbHFWek5hV1ZOVU9HUndDbUpwU0VKQmIwZEJXVkV5UW1oc1JXNU1kRGhtVjBsVmN6UmpLMm8yUVhvd1ltODRVa2RFZG10cVRFWlhRV1pWV1hWTVIzY3dha3czYWxwRE0zQnlMMVlLZW5KamFFMHJSMnhhV1ZrME4zb3dTbEF5TkhCbmVrUnRWaXRKZUZsMU4wUjNUR05uYTNObVdITnlXVmxhYjBOa2R6TkJVeTlYYW5Ga05GTkNSSEJNYWdwVEx6QjBWbVZJY2xsVVoyeHZPV2QwYXpGVmVWazRSU3Q2U0ZGdWJtUmpZWHBCT0hreFdTdE9XR1ZxVERCRFUzRXJWRkU5Q2kwdExTMHRSVTVFSUZKVFFTQlFVa2xXUVZSRklFdEZXUzB0TFMwdENnPT0K
      #- LABS_KUBE_CONF=base64_string_here_of_the_content_of_the .kube/config file_for_example: cat ~/.kube/config | base64      
      #- GOOGLE_CREDENTIALS=base64_string_here_of_the_content_of_the gsa-key.json file_for_example: cat gsa-key.json | base64
      #- SKF_LABS_DEPLOY_MODE=subdomain
      #- JWT_ENABLED="False"
      #- SKF_DOJO_API_KEY=
volumes:
  mysql_data: {}
